# Next.js 多语言路由架构

## URL 结构设计（SEO友好）

### 默认语言（简体中文 zh-CN）
无路由前缀，直接访问：
- `/` - 首页
- `/special/` - 特价游戏列表
- `/special/策略/三国志战略版/` - 特价游戏详情
- `/strategy/` - 攻略列表
- `/strategy/游戏名/攻略标题/` - 攻略详情
- `/games/` - 游戏库
- `/search/` - 搜索

### 其他语言（繁体中文 zh-TW / 英文 en）
带语言前缀：
- `/zh-TW/` - 繁体中文首页
- `/zh-TW/special/` - 繁体中文特价游戏
- `/zh-TW/special/策略/三国志战略版/` - 繁体中文游戏详情
- `/en/special/` - English special games
- `/en/strategy/` - English strategies

## 目录结构

```
src/app/
├── page.tsx                    # 首页（zh-CN）
├── special/                    # 特价游戏（zh-CN）
│   ├── page.tsx
│   └── [...slug]/page.tsx
├── strategy/                   # 攻略（zh-CN）
│   ├── page.tsx
│   └── [...slug]/page.tsx
├── games/page.tsx              # 游戏库（zh-CN）
├── search/page.tsx             # 搜索（zh-CN）
└── [locale]/                   # 多语言路由
    ├── special/                # 特价游戏（zh-TW, en）
    │   ├── page.tsx
    │   └── [...slug]/page.tsx
    ├── strategy/               # 攻略（zh-TW, en）
    │   ├── page.tsx
    │   └── [...slug]/page.tsx
    ├── games/page.tsx          # 游戏库（zh-TW, en）
    └── search/page.tsx         # 搜索（zh-TW, en）
```

## 语言切换机制

### 客户端（LocaleContext）
```tsx
// 用户点击语言切换器
setLocale('zh-TW')

// 自动根据当前路径构建新URL
// /special/策略/三国志战略版/ → /zh-TW/special/策略/三国志战略版/
```

### 服务端（generateStaticParams）
```tsx
// 每个语言页面预生成静态路径
export async function generateStaticParams() {
  return [
    { locale: 'zh-TW' },
    { locale: 'en' },
  ]
}
```

## SEO 优化

### 1. **URL 结构清晰**
- 默认语言无前缀，更简洁
- 其他语言有明确前缀，易于识别

### 2. **独立页面**
- 每个语言版本都是独立的静态页面
- 每个页面有独立的 metadata 和 SEO 标签

### 3. **语言标记**
```tsx
// 每个页面都标记正确的语言
<html lang={locale}>
```

### 4. **Sitemap 支持**
所有语言版本的 URL 都会出现在 sitemap.xml 中

### 5. **Hreflang 标签**（待实现）
```html
<link rel="alternate" hreflang="zh-CN" href="https://example.com/special/" />
<link rel="alternate" hreflang="zh-TW" href="https://example.com/zh-TW/special/" />
<link rel="alternate" hreflang="en" href="https://example.com/en/special/" />
```

## 内容管理

### 文件系统结构
```
src/docs/
├── special/           # zh-CN（默认，fallback）
├── zh-TW/special/     # 繁体中文
├── zh-CN/special/     # 简体中文（可选）
└── en/special/        # 英文
```

### 加载逻辑
```tsx
function getLocalizedDocsDir(locale: Locale): string {
  const localizedDir = path.join(DOCS_DIR, locale)
  // 如果语言目录存在，使用它
  if (fs.existsSync(localizedDir)) {
    return localizedDir
  }
  // 否则回退到默认目录
  return DOCS_DIR
}
```

## API 集成

### 后端多语言支持
```tsx
// 所有 API 调用都携带 locale 参数
ApiClient.getArticles({
  locale: 'zh-TW',
  pageNum: 1,
  pageSize: 10
})
```

### 响应格式
后端返回的数据字段中包含多语言内容，根据 `locale` 参数返回对应语言的数据。

## 配置文件

### locales.ts
```tsx
export const defaultLocale: Locale = 'zh-CN'
export const supportedLocales: Locale[] = ['zh-CN', 'zh-TW', 'en']

export const locales: Record<Locale, LocaleConfig> = {
  'zh-CN': {
    code: 'zh-CN',
    name: '简体中文',
    routePrefix: '',  // 无前缀
    translations: { ... }
  },
  'zh-TW': {
    code: 'zh-TW',
    name: '繁體中文',
    routePrefix: '/zh-TW',
    translations: { ... }
  },
  'en': {
    code: 'en',
    name: 'English',
    routePrefix: '/en',
    translations: { ... }
  }
}
```

## 优势

1. **SEO 友好**：每个语言都有独立的 URL
2. **性能优秀**：静态生成 + ISR
3. **扩展简单**：添加新语言只需添加新文件夹
4. **用户体验好**：语言切换即时生效，URL 直观
5. **向后兼容**：旧的默认语言 URL 保持不变

## 待优化

1. 添加 hreflang 标签
2. 语言自动检测（根据浏览器语言跳转）
3. Sitemap 生成多语言版本
4. robots.txt 配置
5. 语言切换时保留 query 参数
