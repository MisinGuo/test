# 前端开发指南

> 项目：游戏盒子推广站前端  
> 技术栈：Next.js 14 + React 18 + TypeScript + Tailwind CSS  
> 更新日期：2025-12-16

---

## 1. 项目结构

```
game-box-web/
├── src/
│   ├── app/                    # Next.js App Router 页面
│   │   ├── layout.tsx          # 根布局
│   │   ├── page.tsx            # 首页
│   │   ├── globals.css         # 全局样式
│   │   ├── article/            # 文章详情
│   │   │   └── [slug]/
│   │   │       └── page.tsx
│   │   ├── articles/           # 文章列表
│   │   │   └── page.tsx
│   │   ├── boxes/              # 盒子大全
│   │   │   ├── page.tsx
│   │   │   └── BoxesFilterSheet.tsx
│   │   ├── games/              # 游戏库
│   │   │   └── page.tsx
│   │   ├── pojie/              # 破解版内容
│   │   │   ├── page.tsx
│   │   │   └── [...slug]/
│   │   ├── strategy/           # 攻略内容
│   │   │   ├── page.tsx
│   │   │   └── [...slug]/
│   │   └── search/             # 搜索页
│   │       ├── page.tsx
│   │       └── SearchClient.tsx
│   ├── components/             # React 组件
│   │   ├── article/            # 文章相关组件
│   │   │   └── ArticleComponents.tsx
│   │   ├── common/             # 通用组件
│   │   │   └── BoxCard.tsx
│   │   ├── content/            # 内容展示组件
│   │   │   ├── ArticleLayout.tsx
│   │   │   ├── DownloadBox.tsx
│   │   │   └── MarkdownRenderer.tsx
│   │   ├── layout/             # 布局组件
│   │   │   ├── Header.tsx
│   │   │   └── Footer.tsx
│   │   └── ui/                 # shadcn/ui 组件库
│   │       ├── button.tsx
│   │       ├── card.tsx
│   │       ├── dialog.tsx
│   │       └── ...
│   ├── config/                 # 配置文件
│   │   ├── index.ts            # 导出所有配置
│   │   ├── site.ts             # 站点配置
│   │   ├── modules.ts          # 模块配置
│   │   ├── locales.ts          # 国际化配置
│   │   └── types.ts            # 配置类型定义
│   ├── docs/                   # Markdown 内容文档
│   │   ├── pojie/              # 破解版内容
│   │   ├── strategy/           # 攻略内容
│   │   └── zh-CN/              # 中文内容
│   ├── guidelines/             # 开发规范
│   │   └── Guidelines.md
│   └── lib/                    # 工具函数
│       ├── content.ts          # 内容处理
│       └── utils.ts            # 通用工具
├── public/                     # 静态资源
│   └── assets/
│       ├── icon/               # 图标
│       └── img/                # 图片
├── docs/                       # 项目文档
├── next.config.js              # Next.js 配置
├── tailwind.config.js          # Tailwind CSS 配置
├── tsconfig.json               # TypeScript 配置
├── package.json                # 项目依赖
└── README.md                   # 项目说明
```

---

## 2. 开发环境设置

### 2.1 环境要求

- Node.js >= 18.0.0
- pnpm >= 8.0.0（推荐）或 npm/yarn

### 2.2 安装依赖

```bash
# 使用 pnpm
pnpm install

# 或使用 npm
npm install
```

### 2.3 启动开发服务器

```bash
pnpm dev
```

访问 http://localhost:3000

### 2.4 环境变量配置

创建 `.env.local` 文件：

```bash
# 站点 URL
NEXT_PUBLIC_SITE_URL=http://localhost:3000

# API 地址（如需要）
NEXT_PUBLIC_API_URL=http://localhost:8080

# 其他配置
NEXT_PUBLIC_GA_ID=your-ga-id
```

---

## 3. 代码规范

### 3.1 TypeScript

所有代码使用 TypeScript，严格类型检查：

```typescript
// 定义接口
interface BoxProps {
  id: number
  name: string
  description: string
  logo: string
}

// 使用接口
export function BoxCard({ box }: { box: BoxProps }) {
  return <div>{box.name}</div>
}
```

### 3.2 组件编写规范

```typescript
'use client' // 客户端组件需要声明

import { useState } from 'react'
import { Button } from '@/components/ui/button'

interface Props {
  title: string
  onClick?: () => void
}

export function MyComponent({ title, onClick }: Props) {
  const [count, setCount] = useState(0)

  return (
    <div className="p-4">
      <h2 className="text-2xl font-bold">{title}</h2>
      <Button onClick={onClick}>点击: {count}</Button>
    </div>
  )
}
```

### 3.3 样式规范

使用 Tailwind CSS，避免内联样式：

```tsx
// ✅ 推荐
<div className="flex items-center gap-4 p-6 bg-white rounded-lg shadow-md">
  <h3 className="text-xl font-semibold">标题</h3>
</div>

// ❌ 避免
<div style={{ display: 'flex', padding: '24px' }}>
  <h3 style={{ fontSize: '20px' }}>标题</h3>
</div>
```

### 3.4 文件命名规范

- 组件文件：大驼峰 `BoxCard.tsx`
- 工具函数：小驼峰 `utils.ts`
- 页面文件：小写 `page.tsx`
- 配置文件：小写 `site.ts`

---

## 4. 页面开发

### 4.1 创建新页面

在 `src/app/` 下创建路由文件夹：

```
src/app/
└── new-page/
    ├── page.tsx      # 页面组件
    ├── layout.tsx    # 布局（可选）
    └── loading.tsx   # 加载状态（可选）
```

### 4.2 服务端组件（默认）

```typescript
// app/boxes/page.tsx
import { getBoxes } from '@/lib/api'

export default async function BoxesPage() {
  const boxes = await getBoxes()

  return (
    <div>
      <h1>盒子大全</h1>
      {boxes.map(box => (
        <div key={box.id}>{box.name}</div>
      ))}
    </div>
  )
}
```

### 4.3 客户端组件

```typescript
// components/SearchClient.tsx
'use client'

import { useState } from 'react'

export function SearchClient() {
  const [query, setQuery] = useState('')

  return (
    <input
      value={query}
      onChange={(e) => setQuery(e.target.value)}
      placeholder="搜索..."
    />
  )
}
```

### 4.4 静态生成 (SSG)

```typescript
// app/article/[slug]/page.tsx
export async function generateStaticParams() {
  const articles = await getArticles()
  
  return articles.map((article) => ({
    slug: article.slug,
  }))
}

export default async function ArticlePage({ 
  params 
}: { 
  params: { slug: string } 
}) {
  const article = await getArticle(params.slug)
  
  return <div>{article.content}</div>
}
```

### 4.5 增量静态生成 (ISR)

```typescript
// 设置重新验证时间
export const revalidate = 3600 // 1小时

export default async function Page() {
  const data = await fetchData()
  return <div>{data}</div>
}
```

---

## 5. 组件开发

### 5.1 使用 shadcn/ui 组件

```bash
# 添加新组件
pnpm dlx shadcn@latest add button
pnpm dlx shadcn@latest add card
pnpm dlx shadcn@latest add dialog
```

使用组件：

```typescript
import { Button } from '@/components/ui/button'
import { Card, CardHeader, CardTitle } from '@/components/ui/card'

export function MyComponent() {
  return (
    <Card>
      <CardHeader>
        <CardTitle>标题</CardTitle>
      </CardHeader>
      <Button>点击</Button>
    </Card>
  )
}
```

### 5.2 创建自定义组件

```typescript
// components/common/BoxCard.tsx
import { Card } from '@/components/ui/card'
import Image from 'next/image'

interface BoxCardProps {
  box: {
    id: number
    name: string
    logo: string
    description: string
  }
}

export function BoxCard({ box }: BoxCardProps) {
  return (
    <Card className="overflow-hidden hover:shadow-lg transition-shadow">
      <Image 
        src={box.logo} 
        alt={box.name}
        width={200}
        height={200}
      />
      <div className="p-4">
        <h3 className="text-lg font-bold">{box.name}</h3>
        <p className="text-sm text-gray-600">{box.description}</p>
      </div>
    </Card>
  )
}
```

---

## 6. 内容管理

### 6.1 Markdown 文件结构

```markdown
---
title: 文章标题
description: 文章描述
date: 2025-01-01
tags: [标签1, 标签2]
author: 作者
---

# 文章标题

文章内容...

## 二级标题

更多内容...
```

### 6.2 读取 Markdown 内容

```typescript
// lib/content.ts
import fs from 'fs'
import path from 'path'
import matter from 'gray-matter'

export function getArticle(slug: string) {
  const fullPath = path.join(process.cwd(), 'src/docs/strategy', `${slug}.md`)
  const fileContents = fs.readFileSync(fullPath, 'utf8')
  const { data, content } = matter(fileContents)

  return {
    slug,
    content,
    frontmatter: data,
  }
}
```

### 6.3 渲染 Markdown

```typescript
// components/content/MarkdownRenderer.tsx
import ReactMarkdown from 'react-markdown'
import rehypeRaw from 'rehype-raw'

export function MarkdownRenderer({ content }: { content: string }) {
  return (
    <ReactMarkdown 
      rehypePlugins={[rehypeRaw]}
      className="prose prose-lg max-w-none"
    >
      {content}
    </ReactMarkdown>
  )
}
```

---

## 7. 配置管理

### 7.1 站点配置

编辑 `src/config/site.ts`：

```typescript
export const siteConfig = {
  name: "游戏盒子大全",
  description: "最全的游戏盒子推广平台",
  url: "https://yourdomain.com",
  ogImage: "https://yourdomain.com/og.jpg",
  links: {
    github: "https://github.com/yourusername",
  },
}
```

### 7.2 模块配置

编辑 `src/config/modules.ts`：

```typescript
export const modulesConfig = {
  pojie: {
    enabled: true,
    title: "破解版",
    path: "/pojie",
  },
  strategy: {
    enabled: true,
    title: "攻略",
    path: "/strategy",
  },
}
```

---

## 8. 性能优化

### 8.1 图片优化

使用 Next.js Image 组件：

```typescript
import Image from 'next/image'

<Image
  src="/assets/img/banner.jpg"
  alt="Banner"
  width={1200}
  height={600}
  priority // 首屏图片
  placeholder="blur" // 模糊占位
/>
```

### 8.2 代码分割

```typescript
import dynamic from 'next/dynamic'

const HeavyComponent = dynamic(() => import('./HeavyComponent'), {
  loading: () => <p>加载中...</p>,
  ssr: false, // 仅客户端渲染
})
```

### 8.3 数据缓存

```typescript
// 使用 React Cache
import { cache } from 'react'

export const getBoxes = cache(async () => {
  const res = await fetch('/api/boxes')
  return res.json()
})
```

---

## 9. 调试技巧

### 9.1 开发工具

- **React DevTools**：调试组件状态
- **Next.js DevTools**：查看路由和缓存
- **Chrome DevTools**：网络请求和性能分析

### 9.2 日志输出

```typescript
// 开发环境日志
if (process.env.NODE_ENV === 'development') {
  console.log('Debug info:', data)
}
```

### 9.3 错误边界

```typescript
// app/error.tsx
'use client'

export default function Error({
  error,
  reset,
}: {
  error: Error
  reset: () => void
}) {
  return (
    <div>
      <h2>出错了！</h2>
      <button onClick={reset}>重试</button>
    </div>
  )
}
```

---

## 10. 常用命令

```bash
# 开发
pnpm dev              # 启动开发服务器
pnpm build            # 构建生产版本
pnpm start            # 启动生产服务器
pnpm lint             # 代码检查
pnpm type-check       # TypeScript 类型检查

# 组件
pnpm dlx shadcn@latest add [component]  # 添加 UI 组件

# 依赖管理
pnpm add [package]           # 添加依赖
pnpm add -D [package]        # 添加开发依赖
pnpm remove [package]        # 移除依赖
pnpm update                  # 更新依赖
```

---

## 11. 参考资料

- [Next.js 文档](https://nextjs.org/docs)
- [React 文档](https://react.dev)
- [Tailwind CSS 文档](https://tailwindcss.com/docs)
- [shadcn/ui 文档](https://ui.shadcn.com)
- [TypeScript 文档](https://www.typescriptlang.org/docs)
